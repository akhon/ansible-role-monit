check system {{ monit_ansible_role_name }}_system_monitor
  if memory > 80% for 2 cycles then
  {%- if monit_slack_webhook_url is defined %}
    exec "/usr/local/bin/slack.sh" else if succeeded then exec "/usr/local/bin slack.sh"
  {% else %}
    alert
  {% endif -%}
  if swap > 10% for 2 cycles then
  {%- if monit_slack_webhook_url is defined %}
    exec "/usr/local/bin/slack.sh" else if succeeded then exec "/usr/local/bin slack.sh"
  {% else %}
    alert
  {% endif -%}
  if cpu usage (user) > 80% for 4 cycles then
  {%- if monit_slack_webhook_url is defined %}
    exec "/usr/local/bin/slack.sh" else if succeeded then exec "/usr/local/bin slack.sh"
  {% else %}
    alert
  {% endif -%}
  if cpu usage (system) > 40% for 4 cycles then
  {%- if monit_slack_webhook_url is defined %}
    exec "/usr/local/bin/slack.sh" else if succeeded then exec "/usr/local/bin slack.sh"
  {% else %}
    alert
  {% endif -%}
  if cpu usage (wait) > 20% for 4 cycles then
  {%- if monit_slack_webhook_url is defined %}
    exec "/usr/local/bin/slack.sh" else if succeeded then exec "/usr/local/bin slack.sh"
  {% else %}
    alert
  {% endif %}

check filesystem {{ monit_ansible_role_name }}_rootfs with path /
  if space usage > 80% then
  {%- if monit_slack_webhook_url is defined %}
    exec "/usr/local/bin/slack.sh" else if succeeded then exec "/usr/local/bin slack.sh"
  {% else %}
    alert
  {% endif -%}
